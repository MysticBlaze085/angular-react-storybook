{"version":3,"file":"stock-price.js","sourceRoot":"","sources":["../../../src/components/stock-price/stock-price.tsx"],"names":[],"mappings":"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","sourcesContent":["import { Component, Prop, State, Watch, h } from '@stencil/core';\n\nimport {AV_API_KEY} from '../../global/global'\n\n@Component({\n  tag: 'stock-price',\n  styleUrl: 'stock-price.css',\n  shadow: true,\n})\nexport class StockPrice {\n  stockInput: HTMLInputElement;\n  // initialStockSymbole: string;\n  // @Element() el: HTMLElement;\n  @State() fetchedPrice: number;\n  @State() stockUserInput: string;\n  @State() stockInputValid = false;\n  @State() error: string;\n\n  @Prop({mutable: true, reflect: true}) stockSymbol: string;\n\n  @Watch('stockSymbol')\n  stockSymbolChanged(newValue: string, oldValue: string) {\n    if (newValue !== oldValue) {\n      this.stockUserInput = newValue;\n      this.fetchStockPrice(newValue);\n    }\n  }\n\n  onUserInput(event: Event) {\n    this.stockUserInput = (event.target as HTMLInputElement).value;\n    if (this.stockUserInput.trim() !== '') this.stockInputValid = true;\n    else this.stockInputValid = false;\n  }\n\n  onFetchStockPrice(event: Event) {\n    event.preventDefault();\n    // const stockSymbol = (this.el.shadowRoot.querySelector('#stock-symbol') as HTMLInputElement).value;\n    // const stockSymbol = this.stockInput.value;\n    this.stockSymbol = this.stockInput.value;\n    // this.fetchStockPrice(stockSymbol);\n  }\n\n  componentWillLoad() {\n    console.log('commponentWillLoad');\n    console.log(this.stockSymbol);\n    // this.fetchedPrice = 0;\n  }\n\n  componentDidLoad() {\n    console.log('componentDidLoad');\n    if (this.stockSymbol) {\n      // this.initialStockSymbole = this.stockSymbol;\n      this.stockUserInput = this.stockSymbol;\n      this.stockInputValid = true;\n      this.fetchStockPrice(this.stockSymbol);\n    }\n  }\n\n  componentWillUpdate() {\n    console.log('compoenntWillUpdate');\n  }\n\n  componentDidUpdate() {\n    console.log('componentDidUpdate');\n    // if (this.stockSymbol !== this.initialStockSymbole) {\n    //   this.initialStockSymbole = this.stockSymbol;\n    //   this.fetchStockPrice(this.stockSymbol);\n    // }\n  }\n\n  disconnectedCallback() {\n    console.log('disconnectedCallback');\n  }\n\n  fetchStockPrice(stockSymbol: string) {\n    fetch(`https://www.alphavantage.co/query?function=GLOBAL_QUOTE&symbol=${stockSymbol}&apikey=${AV_API_KEY}`)\n    .then((res) => {\n      if (res.status !== 200) {\n        throw new Error('Invalid!');\n      }\n      return res.json();\n    })\n    .then((parsedRes)=> {\n      if (!parsedRes['Global Quote']['05. price']) {\n        throw new Error('Invalid symbol!');\n      }\n      this.error = null;\n      this.fetchedPrice = +parsedRes['Global Quote']['05. price'];\n    })\n    .catch((e) => this.error = e.message);\n  }\n\n  render() {\n    let dataContent = <p>Please enter a symbol</p>;\n    if (this.error) {\n      dataContent = <p>{this.error}</p>\n    }\n    if (this.fetchedPrice) {\n      dataContent = <p>Price: ${this.fetchedPrice}</p>\n    }\n    return (\n      [\n        <form onSubmit={this.onFetchStockPrice.bind(this)}>\n          <input\n            id=\"stock-symbol\"\n            ref={(el) => this.stockInput = el}\n            value={this.stockUserInput}\n            onInput={this.onUserInput.bind(this)} />\n          <button type=\"submit\" disabled={!this.stockInputValid}>Fetch</button>\n        </form>,\n        <div>\n          {dataContent}\n        </div>\n      ]\n    );\n  }\n\n}\n"]}