{"version":3,"names":["AV_API_KEY","stockPriceCss","StockPriceStyle0","StockPrice","stockSymbolChanged","newValue","oldValue","this","stockUserInput","fetchStockPrice","onUserInput","event","target","value","trim","stockInputValid","onFetchStockPrice","preventDefault","stockSymbol","stockInput","componentWillLoad","console","log","componentDidLoad","componentWillUpdate","componentDidUpdate","disconnectedCallback","fetch","then","res","status","Error","json","parsedRes","error","fetchedPrice","catch","e","message","render","dataContent","h","key","onSubmit","bind","id","ref","el","onInput","type","disabled"],"sources":["src/global/global.ts","src/components/stock-price/stock-price.css?tag=stock-price&encapsulation=shadow","src/components/stock-price/stock-price.tsx"],"sourcesContent":["export const AV_API_KEY = 'QKAB4FFTVDRXG1P4';",":host {\n  display: block;\n  border: 2px solid purple;\n  margin: 2rem;\n  padding: 1rem;\n  width: 20rem;\n  max-width: 100%;\n}\n\nform input {\n  font: inherit;\n  color: purple;\n  padding: .15rem .25rem;\n  display: block;\n  margin-bottom: .5rem;\n}\n\nform input:focus, form button:focus {\n  outline: none;\n}\n\nform button {\n  font: inherit;\n  padding: .25rem .5rem;\n  border: 1px solid purple;\n  background: purple;\n  color: white;\n  cursor: pointer;\n}\n\nform button:hover, form button:active {\n  background: rgb(189, 3, 189);\n  border-color: rgb(189, 3, 189);\n}\n\nform button:disabled {\n  background: #ccc;\n  border-color: #ccc;\n  color: white;\n  cursor: not-allowed;\n}","import { Component, Prop, State, Watch, h } from '@stencil/core';\n\nimport {AV_API_KEY} from '../../global/global'\n\n@Component({\n  tag: 'stock-price',\n  styleUrl: 'stock-price.css',\n  shadow: true,\n})\nexport class StockPrice {\n  stockInput: HTMLInputElement;\n  // initialStockSymbole: string;\n  // @Element() el: HTMLElement;\n  @State() fetchedPrice: number;\n  @State() stockUserInput: string;\n  @State() stockInputValid = false;\n  @State() error: string;\n\n  @Prop({mutable: true, reflect: true}) stockSymbol: string;\n\n  @Watch('stockSymbol')\n  stockSymbolChanged(newValue: string, oldValue: string) {\n    if (newValue !== oldValue) {\n      this.stockUserInput = newValue;\n      this.fetchStockPrice(newValue);\n    }\n  }\n\n  onUserInput(event: Event) {\n    this.stockUserInput = (event.target as HTMLInputElement).value;\n    if (this.stockUserInput.trim() !== '') this.stockInputValid = true;\n    else this.stockInputValid = false;\n  }\n\n  onFetchStockPrice(event: Event) {\n    event.preventDefault();\n    // const stockSymbol = (this.el.shadowRoot.querySelector('#stock-symbol') as HTMLInputElement).value;\n    // const stockSymbol = this.stockInput.value;\n    this.stockSymbol = this.stockInput.value;\n    // this.fetchStockPrice(stockSymbol);\n  }\n\n  componentWillLoad() {\n    console.log('commponentWillLoad');\n    console.log(this.stockSymbol);\n    // this.fetchedPrice = 0;\n  }\n\n  componentDidLoad() {\n    console.log('componentDidLoad');\n    if (this.stockSymbol) {\n      // this.initialStockSymbole = this.stockSymbol;\n      this.stockUserInput = this.stockSymbol;\n      this.stockInputValid = true;\n      this.fetchStockPrice(this.stockSymbol);\n    }\n  }\n\n  componentWillUpdate() {\n    console.log('compoenntWillUpdate');\n  }\n\n  componentDidUpdate() {\n    console.log('componentDidUpdate');\n    // if (this.stockSymbol !== this.initialStockSymbole) {\n    //   this.initialStockSymbole = this.stockSymbol;\n    //   this.fetchStockPrice(this.stockSymbol);\n    // }\n  }\n\n  disconnectedCallback() {\n    console.log('disconnectedCallback');\n  }\n\n  fetchStockPrice(stockSymbol: string) {\n    fetch(`https://www.alphavantage.co/query?function=GLOBAL_QUOTE&symbol=${stockSymbol}&apikey=${AV_API_KEY}`)\n    .then((res) => {\n      if (res.status !== 200) {\n        throw new Error('Invalid!');\n      }\n      return res.json();\n    })\n    .then((parsedRes)=> {\n      if (!parsedRes['Global Quote']['05. price']) {\n        throw new Error('Invalid symbol!');\n      }\n      this.error = null;\n      this.fetchedPrice = +parsedRes['Global Quote']['05. price'];\n    })\n    .catch((e) => this.error = e.message);\n  }\n\n  render() {\n    let dataContent = <p>Please enter a symbol</p>;\n    if (this.error) {\n      dataContent = <p>{this.error}</p>\n    }\n    if (this.fetchedPrice) {\n      dataContent = <p>Price: ${this.fetchedPrice}</p>\n    }\n    return (\n      [\n        <form onSubmit={this.onFetchStockPrice.bind(this)}>\n          <input\n            id=\"stock-symbol\"\n            ref={(el) => this.stockInput = el}\n            value={this.stockUserInput}\n            onInput={this.onUserInput.bind(this)} />\n          <button type=\"submit\" disabled={!this.stockInputValid}>Fetch</button>\n        </form>,\n        <div>\n          {dataContent}\n        </div>\n      ]\n    );\n  }\n\n}\n"],"mappings":"2CAAO,MAAMA,EAAa,mBCA1B,MAAMC,EAAgB,whBACtB,MAAAC,EAAeD,E,MCQFE,EAAU,M,wGAMM,M,gDAM3B,kBAAAC,CAAmBC,EAAkBC,GACnC,GAAID,IAAaC,EAAU,CACzBC,KAAKC,eAAiBH,EACtBE,KAAKE,gBAAgBJ,E,EAIzB,WAAAK,CAAYC,GACVJ,KAAKC,eAAkBG,EAAMC,OAA4BC,MACzD,GAAIN,KAAKC,eAAeM,SAAW,GAAIP,KAAKQ,gBAAkB,UACzDR,KAAKQ,gBAAkB,K,CAG9B,iBAAAC,CAAkBL,GAChBA,EAAMM,iBAGNV,KAAKW,YAAcX,KAAKY,WAAWN,K,CAIrC,iBAAAO,GACEC,QAAQC,IAAI,sBACZD,QAAQC,IAAIf,KAAKW,Y,CAInB,gBAAAK,GACEF,QAAQC,IAAI,oBACZ,GAAIf,KAAKW,YAAa,CAEpBX,KAAKC,eAAiBD,KAAKW,YAC3BX,KAAKQ,gBAAkB,KACvBR,KAAKE,gBAAgBF,KAAKW,Y,EAI9B,mBAAAM,GACEH,QAAQC,IAAI,sB,CAGd,kBAAAG,GACEJ,QAAQC,IAAI,qB,CAOd,oBAAAI,GACEL,QAAQC,IAAI,uB,CAGd,eAAAb,CAAgBS,GACdS,MAAM,kEAAkET,YAAsBlB,KAC7F4B,MAAMC,IACL,GAAIA,EAAIC,SAAW,IAAK,CACtB,MAAM,IAAIC,MAAM,W,CAElB,OAAOF,EAAIG,MAAM,IAElBJ,MAAMK,IACL,IAAKA,EAAU,gBAAgB,aAAc,CAC3C,MAAM,IAAIF,MAAM,kB,CAElBxB,KAAK2B,MAAQ,KACb3B,KAAK4B,cAAgBF,EAAU,gBAAgB,YAAY,IAE5DG,OAAOC,GAAM9B,KAAK2B,MAAQG,EAAEC,S,CAG/B,MAAAC,GACE,IAAIC,EAAcC,EAAA,KAAAC,IAAA,qEAClB,GAAInC,KAAK2B,MAAO,CACdM,EAAcC,EAAA,KAAAC,IAAA,4CAAInC,KAAK2B,M,CAEzB,GAAI3B,KAAK4B,aAAc,CACrBK,EAAcC,EAAA,KAAAC,IAAA,uDAAYnC,KAAK4B,a,CAEjC,OAEIM,EAAA,QAAAC,IAAA,2CAAMC,SAAUpC,KAAKS,kBAAkB4B,KAAKrC,OAC1CkC,EAAA,SAAAC,IAAA,2CACEG,GAAG,eACHC,IAAMC,GAAOxC,KAAKY,WAAa4B,EAC/BlC,MAAON,KAAKC,eACZwC,QAASzC,KAAKG,YAAYkC,KAAKrC,QACjCkC,EAAA,UAAAC,IAAA,2CAAQO,KAAK,SAASC,UAAW3C,KAAKQ,iBAAe,UAEvD0B,EAAA,OAAAC,IAAA,4CACGF,G"}